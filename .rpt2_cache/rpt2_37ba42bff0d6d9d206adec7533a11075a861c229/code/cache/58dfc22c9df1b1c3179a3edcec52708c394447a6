{
  "code": "import { Constants } from \"../../Data/Constants\";\r\nimport GamePage from \"../Pages/GamePage\";\r\nimport ES from \"../Singleton/ES\";\r\nimport EventManager from \"../Singleton/EventManager\";\r\nimport GameData from \"../Singleton/GameData\";\r\nimport { EventName } from \"../Singleton/GameDefine\";\r\nimport GameManager from \"../Singleton/GameManager\";\r\nimport { PanelBase, UITYpes } from \"./PanelBase\";\r\nexport default class Relife extends PanelBase {\r\n    constructor() {\r\n        super();\r\n        this.type = UITYpes.PANEL;\r\n        this._time = 5;\r\n        Relife.instance = this;\r\n    }\r\n    onAwake() {\r\n        this._relife = this.owner;\r\n        this._uiBox = this._relife.getChildAt(0);\r\n        this._relifeBtn = this._uiBox.getChildByName(\"RelifeBtn\");\r\n        this._restartBtn = this._uiBox.getChildByName(\"AgainBtn\");\r\n        this._title = this._uiBox.getChildByName(\"Title\");\r\n        this._timerImg = this._uiBox.getChildByName(\"Timer\");\r\n    }\r\n    onEnable() {\r\n        this._relifeBtn.on(Laya.Event.CLICK, this, this.playerRelfie.bind(this));\r\n        this._restartBtn.on(Laya.Event.CLICK, this, this.playAgain.bind(this));\r\n    }\r\n    onDisable() {\r\n        this._relifeBtn.offAll();\r\n    }\r\n    show(type = 0) {\r\n        super.show();\r\n        console.log(type, \"type\");\r\n        switch (type) {\r\n            case 0:\r\n                this._relifeBtn.visible = true;\r\n                this._restartBtn.visible = true;\r\n                this._title.visible = false;\r\n                this.showCountdown();\r\n                break;\r\n            case 1:\r\n                this._timerImg.visible = false;\r\n                this._relifeBtn.visible = false;\r\n                this._restartBtn.visible = true;\r\n                this._title.visible = true;\r\n                break;\r\n        }\r\n    }\r\n    hide() {\r\n        super.hide();\r\n    }\r\n    playerRelfie() {\r\n        Laya.timer.clear(this, this._refreshCountdown);\r\n        GamePage.instance.hidePage(Constants.UIPage.relife, () => {\r\n            GamePage.instance.showPage(Constants.UIPage.playing, () => {\r\n                EventManager.dispatchEvent(EventName.PLAYER_RELIFE);\r\n            });\r\n        });\r\n    }\r\n    playAgain() {\r\n        Laya.timer.clear(this, this._refreshCountdown);\r\n        GamePage.instance.hidePage(Constants.UIPage.relife, () => {\r\n            ES.instance.event(ES.on_clear_scene);\r\n            GamePage.instance.showPage(Constants.UIPage.loading);\r\n            GameManager.instance().loadLevel(GameData.level).then(() => {\r\n                console.log('init scene complete');\r\n                GamePage.instance.hidePage(Constants.UIPage.loading, () => {\r\n                    GamePage.instance.showPage(Constants.UIPage.home, null);\r\n                });\r\n            });\r\n        });\r\n    }\r\n    showCountdown() {\r\n        this._time = 5;\r\n        this._timerImg.skin = \"textures/d5.png\";\r\n        this._timerImg.visible = true;\r\n        this._relifeBtn.visible = true;\r\n        Laya.timer.loop(1000, this, this._refreshCountdown);\r\n    }\r\n    _refreshCountdown() {\r\n        if (this._time > 0) {\r\n            this._time--;\r\n        }\r\n        if (this._time === 0) {\r\n            this._timerImg.visible = false;\r\n            this._relifeBtn.visible = false;\r\n            Laya.timer.clear(this, this._refreshCountdown);\r\n            return;\r\n        }\r\n        this._timerImg.skin = `textures/d${this._time}.png`;\r\n    }\r\n}\r\nRelife.instance = null;\r\n",
  "references": [
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Data/Constants.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Entity/Player.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Pages/GamePage.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/ES.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/EventManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/GameData.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/GameDefine.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/GameManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/UI/PanelBase.ts"
  ]
}
