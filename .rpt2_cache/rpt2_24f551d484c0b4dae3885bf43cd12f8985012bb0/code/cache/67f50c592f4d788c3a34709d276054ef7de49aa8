{
  "code": "import { SdkUitl } from \"../../Util/SdkUitl\";\r\nimport GameManager from \"../Singleton/GameManager\";\r\nconst width = 530;\r\nexport default class LoadingPage extends Laya.Script {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._isSubload = false;\r\n        this._enterGame = false;\r\n    }\r\n    onAwake() {\r\n        this.uiBox = this.owner.getChildAt(0);\r\n        this.progress = this.owner.getChildByName(\"progress\");\r\n        this.progress.width = 1;\r\n    }\r\n    onStart() {\r\n        console.log(\"onStart\");\r\n        this.loadSubPackages();\r\n    }\r\n    onUpdate() {\r\n        if (Laya.timer.delta > 100)\r\n            return;\r\n        if (this._enterGame)\r\n            return;\r\n        this._refreshProgress();\r\n    }\r\n    loadSubPackages() {\r\n        this._subTask = SdkUitl.loadSubpackage(\"sub1\", () => {\r\n            this.subCallback();\r\n        });\r\n        if (this._subTask) {\r\n            this._subTask.onProgressUpdate(res => {\r\n                this._subProgress = res.progress;\r\n            });\r\n        }\r\n    }\r\n    _refreshProgress() {\r\n        if (this.progress.width <= 0.9 * width) {\r\n            if (this._subTask) {\r\n                this.progress.width = this._subProgress * 0.9 * width;\r\n            }\r\n            else {\r\n                this.progress.width += Laya.timer.delta / 1000 * 0.5 * width;\r\n            }\r\n        }\r\n        else {\r\n            if (this._isSubload) {\r\n                this.progress.width += Laya.timer.delta / 1000 * 0.2 * width;\r\n            }\r\n            if (this.progress.width >= width) {\r\n                this.enterGame();\r\n            }\r\n        }\r\n    }\r\n    subCallback() {\r\n        if (!this._isSubload) {\r\n            Laya.Scene.open(\"Scenes/Game.scene\", false);\r\n            this._isSubload = true;\r\n        }\r\n    }\r\n    enterGame() {\r\n        if (!this._enterGame && GameManager.instance().isGameReady) {\r\n            console.log(\"enter game!\");\r\n            Laya.Scene.close(\"Scenes/Start.scene\");\r\n            this._enterGame = true;\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Util/SdkUitl.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Util/WeChatManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/GameManager.ts"
  ]
}
