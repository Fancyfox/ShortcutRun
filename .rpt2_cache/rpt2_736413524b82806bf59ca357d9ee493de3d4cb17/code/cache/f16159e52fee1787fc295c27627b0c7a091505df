{
  "code": "import RandomUtil from \"./RandomUtil\";\r\nconst templateId_tt = \"\";\r\nconst videoAdUnitId_wx = \"\";\r\nconst videoAdUnitId_tt = \"\";\r\nexport class SdkUitl {\r\n    static share(isRecord = false, succesCallback, failCallback) {\r\n        if (Laya.Browser.onWeiXin) {\r\n            var r = Math.random();\r\n            let n = r < 0.25 ? 1 : r < 0.5 ? 2 : r < 0.75 ? 3 : 4;\r\n            wx.shareAppMessage({\r\n                title: this.shareWords[n - 1],\r\n                imageUrl: \"subPackage/sub2/Share/\" + String(n) + \".jpg\",\r\n                query: \"\",\r\n            });\r\n            var startTime = new Date().getTime();\r\n            var LeaveBack = function () {\r\n                wx.offHide(LeaveBack);\r\n            };\r\n            wx.onHide(LeaveBack);\r\n            var callback = function () {\r\n                wx.offShow(callback);\r\n                var endTime = new Date().getTime();\r\n                if (Math.abs(startTime - endTime) < 3000) {\r\n                    failCallback && failCallback();\r\n                }\r\n                else {\r\n                    succesCallback && succesCallback();\r\n                }\r\n            };\r\n            wx.onShow(callback);\r\n        }\r\n        if (Laya.Browser.window.tt) {\r\n            if (!tt.shareAppMessage) {\r\n                return;\r\n            }\r\n            let i = RandomUtil.RandomInteger(0, this.images.length);\r\n            let title = this.images[i]['des' + RandomUtil.RandomInteger(1, 4)];\r\n            let imageUrl = this.images[i].imageUrlId;\r\n            if (!isRecord) {\r\n                tt.shareAppMessage({\r\n                    title: title,\r\n                    templateId: templateId_tt,\r\n                    imageUrl: imageUrl,\r\n                    query: \"\",\r\n                    success: () => {\r\n                    },\r\n                    fail: () => {\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                console.log(this._videoPath, \"this.videoPath\");\r\n                tt.shareAppMessage({\r\n                    channel: \"video\",\r\n                    title: title,\r\n                    query: \"\",\r\n                    templateId: templateId_tt,\r\n                    extra: {\r\n                        videoPath: this._videoPath,\r\n                        videoTopics: [\"动物经纪人\"],\r\n                        hashtag_list: [\"动物经纪人\"]\r\n                    },\r\n                    success: (res) => {\r\n                        console.log(\"录屏发布成功\", res);\r\n                        if (succesCallback) {\r\n                            succesCallback();\r\n                            this._videoPath = \"\";\r\n                        }\r\n                    },\r\n                    fail: (res) => {\r\n                        if (!isRecord) {\r\n                            return;\r\n                        }\r\n                        let errs = res.errMsg.split(\":\");\r\n                        console.log(errs[1], \"errs录屏发布失败\");\r\n                        if (errs[1].search(\"cancel\") == -1) {\r\n                            if (failCallback) {\r\n                                failCallback();\r\n                            }\r\n                            return;\r\n                        }\r\n                        console.log(\"取消发布录屏\");\r\n                        if (failCallback) {\r\n                            failCallback();\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    static passiveShare(withShareTicket = false) {\r\n        if (Laya.Browser.onWeiXin) {\r\n            wx.showShareMenu({\r\n                withShareTicket: withShareTicket,\r\n                success: () => {\r\n                    wx.onShareAppMessage(() => {\r\n                        var r = Math.random();\r\n                        let n = r < 0.25 ? 1 : r < 0.5 ? 2 : r < 0.75 ? 3 : 4;\r\n                        return {\r\n                            title: this.shareWords[n - 1],\r\n                            imageUrl: \"subPackage/sub2/Share/\" + String(n) + \".jpg\",\r\n                            query: \"\",\r\n                            success: () => {\r\n                            }\r\n                        };\r\n                    });\r\n                },\r\n                fail: () => {\r\n                    console.log(\"显示当前页面的转发按钮--失败！\");\r\n                }\r\n            });\r\n        }\r\n        if (Laya.Browser.window.tt) {\r\n            tt.showShareMenu && tt.showShareMenu({\r\n                withShareTicket: true,\r\n                success: () => {\r\n                    tt.onShareAppMessage(() => {\r\n                        let i = RandomUtil.RandomInteger(0, this.images.length);\r\n                        var share = {\r\n                            title: this.images[i]['des' + RandomUtil.RandomInteger(1, 4)],\r\n                            imageUrl: this.images[i].imageUrl,\r\n                            query: \"\"\r\n                        };\r\n                    });\r\n                }\r\n            });\r\n        }\r\n        return;\r\n    }\r\n    static createVideoRewardAd() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            if (!wx.createRewardedVideoAd) {\r\n                return;\r\n            }\r\n            let videoRewardAd = wx.createRewardedVideoAd({\r\n                adUnitId: videoAdUnitId_wx\r\n            });\r\n            videoRewardAd.onLoad && videoRewardAd.onLoad(function (res) {\r\n                console.log(\"视频广告加载完成\", res.errMsg);\r\n            });\r\n            videoRewardAd.onError && videoRewardAd.onError(function (res) {\r\n                console.log(\"视频广告加载失败\", res.errMsg);\r\n                videoRewardAd.load && videoRewardAd.load();\r\n            });\r\n            videoRewardAd.onClose && videoRewardAd.onClose(this.handler.bind(this));\r\n            return;\r\n        }\r\n        if (Laya.Browser.window.tt) {\r\n            if (!tt.createRewardedVideoAd) {\r\n                return;\r\n            }\r\n            this._videoRewardAd = wx.createRewardedVideoAd({\r\n                adUnitId: videoAdUnitId_tt\r\n            });\r\n            this._videoRewardAd.onLoad && this._videoRewardAd.onLoad(function (res) {\r\n                console.log(\"视频广告加载完成\", res.errMsg);\r\n            });\r\n            this._videoRewardAd.onError && this._videoRewardAd.onError(function (res) {\r\n                console.log(\"视频广告加载失败\", res.errMsg);\r\n                this._videoRewardAd.load && this._videoRewardAd.load();\r\n            });\r\n            this._videoRewardAd.onClose && this._videoRewardAd.onClose(this.handler.bind(this));\r\n        }\r\n    }\r\n    static closeHandler(res) {\r\n        if (res && res.isEnded || res === undefined) {\r\n            console.log(\"给予奖励\");\r\n            this.videoSuccessCallback && this.videoSuccessCallback();\r\n        }\r\n        else {\r\n            console.log(\"未看完广告\");\r\n            this.videoFailCallback && this.videoFailCallback();\r\n        }\r\n    }\r\n    static setVideoRewardAdCloseEvent(succesCallback, failCallback) {\r\n        this.videoSuccessCallback = succesCallback;\r\n        this.videoFailCallback = failCallback;\r\n    }\r\n    static showVideoReward(successCallback, failCallback) {\r\n        if (!this._videoRewardAd) {\r\n            return;\r\n        }\r\n        if (!this._videoRewardAd.show) {\r\n            return;\r\n        }\r\n        this._videoRewardAd.show().then(() => {\r\n            console.log(\"视频广告显示成功，暂停背景音乐\");\r\n            SdkUitl.setVideoRewardAdCloseEvent(successCallback, failCallback);\r\n        }, err => {\r\n            console.log(\"视频广告显示失败\", err);\r\n            this._videoRewardAd.load();\r\n        });\r\n    }\r\n    static playMusic(name, loop = true) {\r\n        if (Laya.Browser.onWeiXin) {\r\n            if (wx.createInnerAudioContext) {\r\n                this._audio = wx.createInnerAudioContext();\r\n                this._audio.src = `subPackage/sub2/Audio/Effect/${name}.mp3`;\r\n                this._audio.autoplay = true;\r\n                this._audio.loop = true;\r\n                this._audio.play();\r\n            }\r\n            return;\r\n        }\r\n        if (Laya.Browser.window.tt) {\r\n            if (tt.createInnerAudioContext) {\r\n                this._audio = tt.createInnerAudioContext();\r\n                this._audio.src = `subPackage/sub2/Audio/Effect/${name}.mp3`;\r\n                ;\r\n                this._audio.autoplay = true;\r\n                this._audio.loop = true;\r\n                this._audio.play();\r\n            }\r\n        }\r\n        let url = `subPackage/sub2/Audio/Effect/${name}.mp3`;\r\n        let bgmLoop = loop ? 0 : 1;\r\n        Laya.SoundManager.playMusic(url, bgmLoop);\r\n    }\r\n    static loadSubpackage(name, callBack) {\r\n        if (Laya.Browser.onWeiXin) {\r\n            if (wx.loadSubpackage) {\r\n                let task = wx.loadSubpackage({\r\n                    name: name,\r\n                    success: function (res) {\r\n                        callBack && callBack();\r\n                    },\r\n                    fail: function (res) {\r\n                    }\r\n                });\r\n                return task;\r\n            }\r\n        }\r\n        callBack && callBack();\r\n        return null;\r\n    }\r\n    static vibrateShort() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            wx.vibrateShort && wx.vibrateShort({\r\n                type: \"light\"\r\n            });\r\n            return;\r\n        }\r\n        if (Laya.Browser.window.tt) {\r\n            tt.vibrateShort && tt.vibrateShort();\r\n            return;\r\n        }\r\n    }\r\n    static ShowToast(title = \"\", icon = \"none\", duration = 1500) {\r\n        if (Laya.Browser.window.wx) {\r\n            wx.showToast({\r\n                title: title,\r\n                icon: icon,\r\n                duration: duration,\r\n            });\r\n        }\r\n    }\r\n}\r\nSdkUitl.images = [\r\n    {\r\n        des1: '搬砖搬的好，躺平躺的快~',\r\n        des2: '谁才是直播界带货一哥？',\r\n        des3: '招募主播，直播带货，生意蒸蒸日上！',\r\n        imageUrlId: 'M9YkQjdARgCfpupY+bmNWg==',\r\n        imageUrl: 'https://mmocgame.qpic.cn/wechatgame/svmLHWrwdtCYgLpZSS63QZgMVfWXicOgOzkRYs9U4MWJvcqhRlkCc5RX6yYzNftB3/0'\r\n    },\r\n    {\r\n        des1: '音乐奇才，无人倾听，经纪人们快来帮帮他~',\r\n        des2: '情歌天王，千万人气，为何深夜独自神伤？',\r\n        des3: '流浪歌手到亚洲歌王，阿呆的梦想！',\r\n        imageUrlId: 'tG+4Q4WqTjGtAYjdg8YDNA==',\r\n        imageUrl: 'https://mmocgame.qpic.cn/wechatgame/svmLHWrwdtCXN4yFyb3E95qdaYVoTxia4fOntH6sDskhelq7sK7CPlCgKunhQ3keb/0'\r\n    },\r\n    {\r\n        des1: '猪二蛋：欢迎来的我的直播间！',\r\n        des2: '打造属于你自己的直播天团吧！',\r\n        des3: '大胃王猪二蛋高调路过，聘请他来直播吧~',\r\n        imageUrlId: 'xbKpyKtLQAi4ieYtjqNVUw==',\r\n        imageUrl: 'https://mmocgame.qpic.cn/wechatgame/svmLHWrwdtDVs2rjY0ZJKXlnhB8STMuHiaibI7C7iaSSvgjjHDmToalpa7uHzfiaKuibx/0'\r\n    }\r\n];\r\nSdkUitl._videoPath = \"\";\r\nSdkUitl.shareWords = [\"搬砖搬的好，躺平躺的快~\",\r\n    \"打工人，打工魂，我是最强搬砖人！\",\r\n    \"还好我搬的砖多，不然就掉下去了！\",\r\n    \"宝~我今天扛了好多砖，但就是扛不住想你~\"];\r\nSdkUitl.handler = SdkUitl.closeHandler;\r\nSdkUitl._audio = null;\r\n",
  "references": [
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Util/RandomUtil.ts"
  ]
}
