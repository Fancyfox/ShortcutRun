{
  "code": "import { CharactorManager } from \"../../Data/CharactorManager\";\r\nimport { Constants } from \"../../Data/Constants\";\r\nimport { StaticDataManager } from \"../../Tmpl/StaticDataManager\";\r\nimport { SdkUitl } from \"../../Util/SdkUitl\";\r\nimport GamePage from \"../Pages/GamePage\";\r\nimport AudioManager from \"../Singleton/AudioManager\";\r\nimport EventManager from \"../Singleton/EventManager\";\r\nimport { EventName } from \"../Singleton/GameDefine\";\r\nimport { ShopManager } from \"../Singleton/ShopManager\";\r\nimport PlankShopItem from \"./Compoments/PlankShopItem\";\r\nimport { PanelBase } from \"./PanelBase\";\r\nexport default class Shop extends PanelBase {\r\n    constructor() {\r\n        super();\r\n        Shop.instance = this;\r\n    }\r\n    onAwake() {\r\n        this._shop = this.owner;\r\n        this._uiBox = this._shop.getChildAt(0);\r\n        this._plankList = this._uiBox.getChildByName(\"PlankList\");\r\n        this._listBox = this._plankList.getChildAt(0);\r\n        this._unLockBtn = this._uiBox.getChildByName(\"CoinUnlockBtn\");\r\n        this._priceLabel = this._unLockBtn.getChildByName(\"CoinCount\");\r\n        this._adBtn = this._uiBox.getChildByName(\"AdBtn\");\r\n        this._homeBtn = this._uiBox.getChildByName(\"HomeBtn\");\r\n        this.show();\r\n    }\r\n    onStart() {\r\n        this._unLockBtn.on(Laya.Event.CLICK, this, this.randomUnlcok);\r\n        this._adBtn.on(Laya.Event.CLICK, this, this.addMoneyByAD);\r\n        this._homeBtn.on(Laya.Event.CLICK, this, this.showHomeView);\r\n        EventManager.register(EventName.SHOP_PLANK_BUY, this._refeshUI, this);\r\n        EventManager.register(EventName.SHOP_PLANK_CHOOSE, this._refeshUI, this);\r\n    }\r\n    show() {\r\n        if (!this._shop) {\r\n            return;\r\n        }\r\n        if (this._listBox.numChildren > 0) {\r\n            this._refeshUI();\r\n            return;\r\n        }\r\n    }\r\n    _refeshUI() {\r\n        let tmpls = StaticDataManager.getPlanksRecord();\r\n        let index = 0;\r\n        for (let key in tmpls) {\r\n            let item = this._listBox.getChildAt(index).getChildAt(0);\r\n            const comp = item.getComponent(PlankShopItem);\r\n            comp.setData(key);\r\n            index++;\r\n        }\r\n        if (!ShopManager.instance().isAllUnlock()) {\r\n            this._unLockBtn.visible = true;\r\n            this._priceLabel.text = (ShopManager.instance().getUnlockCount() * 1500).toString();\r\n        }\r\n        else {\r\n            this._unLockBtn.visible = false;\r\n        }\r\n    }\r\n    randomUnlcok() {\r\n        ShopManager.instance().unlockPlankByMoney();\r\n    }\r\n    showHomeView() {\r\n        AudioManager.instance().playEffect(\"Click\");\r\n        GamePage.instance.hidePage(Constants.UIPage.shop, () => {\r\n            GamePage.instance.showPage(Constants.UIPage.home);\r\n        });\r\n    }\r\n    addMoneyByAD() {\r\n        AudioManager.instance().playEffect(\"Click\");\r\n        SdkUitl.ShowToast(\"暂无广告~\");\r\n        return;\r\n        CharactorManager.instance().addMoney(1500);\r\n    }\r\n}\r\nShop.instance = null;\r\n",
  "references": [
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Data/CharactorManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Data/Constants.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Tmpl/StaticDataManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/Util/SdkUitl.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Pages/GamePage.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/AudioManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/EventManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/GameDefine.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/Singleton/ShopManager.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/UI/Compoments/PlankShopItem.ts",
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/script/UI/PanelBase.ts"
  ]
}
