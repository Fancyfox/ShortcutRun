{
  "code": "import WeChatManager from \"../../WeChat/WeChatManager\";\r\nexport default class LoadingPage extends Laya.Script {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._isSubload = false;\r\n        this._enterGame = false;\r\n    }\r\n    onAwake() {\r\n        this.uiBox = this.owner.getChildAt(0);\r\n        this.progress = this.uiBox.getChildByName(\"ProgressBar\");\r\n    }\r\n    onStart() {\r\n        console.log(\"onStart\");\r\n        this.progress.value = 0;\r\n        this.loadSubPackages();\r\n    }\r\n    onUpdate() {\r\n        if (Laya.timer.delta > 100)\r\n            return;\r\n        if (this._enterGame)\r\n            return;\r\n        if (this.progress.value <= 0.9) {\r\n            this.progress.value += Laya.timer.delta / 1000 * 0.3;\r\n        }\r\n        else {\r\n            if (this._isSubload) {\r\n                this.progress.value += Laya.timer.delta / 1000 * 0.1;\r\n            }\r\n            if (this.progress.value >= 1) {\r\n                this.enterGame();\r\n            }\r\n        }\r\n    }\r\n    loadSubPackages() {\r\n        let p1 = new Promise(reslove => {\r\n            WeChatManager.LoadSubpackage(\"sub1\", () => {\r\n                reslove();\r\n            });\r\n        });\r\n        let p2 = new Promise(reslove => {\r\n            WeChatManager.LoadSubpackage(\"sub2\", () => {\r\n                reslove();\r\n            });\r\n        });\r\n        Promise.all([p1, p2]).then(() => {\r\n            if (!this._isSubload) {\r\n                Laya.Scene.open(\"Scenes/Game.scene\", false);\r\n                this._isSubload = true;\r\n            }\r\n        });\r\n    }\r\n    enterGame() {\r\n        if (!this._enterGame) {\r\n            console.log(\"enter game!\");\r\n            Laya.Scene.close(\"Scenes/Start.scene\");\r\n            this._enterGame = true;\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/WorkSpace/Laya2.6.1/ShortcutRun/src/WeChat/WeChatManager.ts"
  ]
}
